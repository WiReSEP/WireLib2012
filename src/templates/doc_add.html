{% extends "index.html" %}
{% block header %}
function addAuthor(div_id, elem, edau) {
	var auths = document.getElementsByName(edau+'_last_name');
	var last_auth = auths[auths.length-2];
	if(last_auth.value == '')
	  return;
	var new_div = document.createElement('tr');
    new_div.innerHTML = '<td><input type=text name='+edau+'"_first_name" maxlength=30 /></td> <td><input onFocus="addAuthor(\'' + div_id + '\', this, '+edau+')" type=text name='+edau+'"_last_name" maxlength=30 /></td>';
    elem.removeAttribute('onFocus');
    document.getElementById(div_id).appendChild(new_div);
}

function addExtra(div_id, elem) {
  var extras = document.getElementsByName('doc_extra_name');
  var last_extra = extras[extras.length-1];
  if(last_extra.value == '')
	return;
  var new_div = document.createElement('tr');
  new_div.innerHTML = '<td><input type=text name="doc_extra_name" /></td> <td><input onFocus="addExtra(\'' + div_id + '\', this)" type=text name="doc_extra_content" /></td>'
    elem.removeAttribute('onFocus');
    document.getElementById(div_id).appendChild(new_div);
}

function addKeyword(div_id, elem) {
  var keys = document.getElementsByName('keyword');
  var last_key = keys[keys.length-2];
  if(last_key.value == '')
	return;
  var new_div = document.createElement('tr');
  new_div.innerHTML = '<td><input onFocus="addKeyword(\'' + div_id + '\', this)" type=text name="keyword" /></td>'
    elem.removeAttribute('onFocus');
    document.getElementById(div_id).appendChild(new_div);
}

var needs = new Array();
{% for c, value in category_needs.items %}
  needs = new Object();
  needs.{{ c }} = new Array();
  n = needs.{{ c }};
  {% for need in value %}
	n[n.length] = '{{ need }}';
  {% endfor %}
{% endfor %}

function changeCategory(elem) {
  arr = needs[elem.value];
  labels = document.getElementsByTagName('label');
  for (i=0; i </*>*/ labels.length; ++i) { 
	labels[i].innerHTML = ' ';
  }
  for (i=0; i </*>*/ arr.length; ++i) {
	field = document.getElementById(arr[i] + '_l');
	field.innerHTML = '*';
  }
}
{% endblock header %}
{% block content %}

    <h1>Import</h1>

	<div id="spoiler" name="spoiler">
	  <form method="post" action="">
	    <table>
	        <tr>
	            <td><b><u>Titel:</u></b></td>
				<td>
				  <label for="title" id="title_l"> </label> 
				  <input type="text" name="title" id="title" maxlength=200 />
				</td>
	        </tr>
	        <tr>
	            <td><b><u>bib_no:</u></b></td>
				<td>
				  <label for="bib_no" id="bib_no_l"></label> 
				  <input type="text" name="bib_no" id="title" maxlength=15 />
				</td>
	        </tr>
            <tr>
	            <td><b><u>inv_no:</u></b></td>
				<td>
				  <label for="inv_no" id="inv_no_l"></label>
				  <input type="text" name="inv_no" id="inv_no" maxlength=15 />
				</td>
	        </tr>  
            <tr>
	            <td><b><u>Kategorie:</u></b></td>
				<td> 
				  <label for="category" id="category_l"></label>
				  <select name="category" 
					id="category"
					size="1"
					onchange="changeCategory(this);" >
	                    {% for c in category %}
	                        <option value="{{ c }}">{{ c }}</option>
	                    {% endfor %}
	                </select>
	            </td>
	        </tr>  
	        <tr>
	            <td><b><u>ISBN:</u></b></td>
				<td> 
				  <label for="isbn" id="isbn_l"></label>
				  <input type="text" name="isbn" id="isbn" maxlength=35/>
				</td>
	        </tr>
	        <tr>
	            <td><b><u>Publisher:</u></b></td>
				<td>
				  <label for="publisher" id="publisher_l"></label> 
				  <input type="text" name="publisher" id="publisher" maxlength=35/>
				</td>
	        </tr>
	        <tr>
	            <td><b><u>Erscheinungsjahr:</u></b></td>
				<td>
				  <label for="year" id="year_l"></label> 
				  <input type="text" name="year" id="year" maxlength=4 />
				</td>
	        </tr> 
	        <tr>
	            <td><b><u>Adresse:</u></b></td>
				<td> 
				  <label for="address" id="address_l"></label>
				  <input type="text" name="address" id="address" maxlength=100 />
				</td>
	        </tr>
	        <tr>
	            <td><b><u>Notizen:</u></b></td>
				<td> 
				  <label for="comment" id="comment_l"></label>
				  <input type="textfield" name="comment" id="comment"/>
				</td>
	        </tr>
	        <tr>
	            <td><b><u>Preis:</u></b></td>
				<td> 
				  <label for="price" id="price_l"></label>
				  <input type="text" name="price" id="price" maxlength=7 />
				</td>
	        </tr>
	        <tr>
	            <td><b><u>WÃ¤hrung (K&uuml;rzel)</u></b></td>
				<td> 
				  <label for="currency" id="currency_l"></label>
				  <input type="text" name="currency" id="currency" maxlength=3 />
				</td>
	        </tr>
	        <tr>
	            <td><b><u>Libary of Congress Number:</u></b></td>
				<td> 
				  <label for="lib_of_con_nr" id="lib_of_con_nr_l"></label>
				  <input type="text" name="lib_of_con_nr" id="lib_of_con_nr" maxlength=20 />
				</td>
	        </tr>
	    </table>
	
	    <b><u>Autoren</u></b> <br />
	    <table>
	        <tbody id=au>
	        <tr>
			  <label id="author_l"></label>
	            <th>Vorname</th>
	            <th>Nachname</th>
	        </tr>
	        <tr>
	            <td><input type="text" name="author_first_name"  maxlength=30 /></td>
	            <td><input type="text" name="author_last_name" maxlength=30 /></td>
	        </tr>
			<tr>
				<td><input type="text" name="author_first_name"  maxlength=30 /></td>
				<td><input type="text" onFocus="addAuthor('au', this, author)" name="author_last_name" maxlength=30 /></td>
			</tr>
            </tbody>
	    </table>
	    
	    <b><u>Editoren</u></b> <br />
	    <table>
	        <tbody id=ed>
	        <tr>
	            <label id="editor_l"></label>
	                <th>Vorname</th>
	                <th>Nachname</th>
	        </tr>
	        <tr>
                <td><input type="text" name="editor_first_name"  maxlength=30 /></td>
	            <td><input type="text" name="editor_last_name" maxlength=30 /></td>
	        </tr>
			<tr>
				<td><input type="text" name="editor_first_name"  maxlength=30 /></td>
				<td><input type="text" onFocus="addAuthor('au', this, editor)" name="editor_last_name" maxlength=30 /></td>
			</tr>
            </tbody>
	    </table>
	
	    <b><u>Schl&uuml;sselw&ouml;rter:</u></b><br />
	    <table>
	        <tbody id=kw>
	        <tr>
			  <td>
				<label id="keyword_l"></label>
				<input type="text" name="keyword" maxlength=30 />
			  </td>
	        </tr>
			<tr>
				<td><input type="text" onFocus="addKeyword('kw', this)" name="keyword" maxlength=30 /></td>
			</tr>
            </tbody> 
	    </table>
	
	    <b><u>Extrafelder:</u></b><br />
	    <table>
	        <tbody id=ex>
			  <tr>
				<label id="extras"></label>
	            <th>Feldname</th>
	            <th>Feldinhalt</th>
	        </tr>
	        <tr>
	            <td><input type="text" name="doc_extra_name" maxlength=30 /></td>
	            <td><input type="text" onFocus="addExtra('ex', this)" name="doc_extra_content" maxlength=30 /></td>
	        </tr>
            </tbody> 
	    </table>
	    <input type="submit" name="submit" value="Dokument speichern" />
	  </form>
	</div>
	<br />
	<hr />
	<br />
	<form method="post" action="" enctype="multipart/form-data">
  	  {{ form.as_p }}
  	  <p><input type="submit" value="Start" /></p>
  </form>
  {% if success == 1 %}
    <font color="#FF0000"> {{ message|linebreaksbr }}</font>
  {% else %}
    <font color="#00FF00"> {{ message|linebreaksbr }} </font>
  {% endif %}  
{% endblock content %}
