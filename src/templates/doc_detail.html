{% extends "index.html" %}
{% block content %}

<h1>{{ documents.title }}</h1> 
<table width="100%" >
<tr>
		  <td><b>Status:   </td>   </b>
		  <td>
{% if documents.status == 0 %}
         Vorhanden
{% endif %}     
{% if documents.status == 1 %}
    Ausgeliehen
{% endif %} 
{% if documents.status == 2 %}
    Bestellt
{% endif %} 
{% if documents.status == 3 %}
    Vermisst
{% endif %} 
{% if documents.status == 4 %}
    Verloren
{% endif %} 
</td>
		</tr>

  
	  
	  <tr>
		  <td><b>Autor:</b></td>
		  <td>
			{% for a in documents.authors.all %}
			{{ a.first_name }} {{ a.last_name }},
			{% endfor %}
		  </td>
		</tr>
		<tr>
		  <td><b>Kategorie:</b></td>
		  <td>{{ documents.category }}</td>
		</tr>
		<tr>
		  <td><b>Publisher:</b></td>
		  <td>
			{% if documents.publisher %}
			{{ documents.publisher }}
			{% else %}
			-
			{% endif %}
		  </td>
		<tr>
		  <td><b>Erscheinungsjahr:</b></td>
		  <td>{{ documents.year }}</td>
		</tr>
		<tr>
		  <td><b>Schlüsselwörter:</b></td>
		  <td>
			<!-- TODO funktioniert vermutlich auch noch nicht wirklich -->
			{% if documents.keywords_set.all %}
			{% for k in documents.keywords_set.all %}
			{{ k.keyword }},
			{% endfor %}
			{% else %}
			-
			{% endif %}
		  </td>
		</tr>	    
		<tr>
		  <td><b>In der Bibliothek seit:</b></td>
		  <td>{{ documents.date_of_purchase }}</td>
		</tr>
		<tr>
		  <td><b>Notizen:</b></td>
		  <td>
			{% if documents.comment %}
			{{ documents.comment }}
			{% else %}
			-
			{% endif %}
		  </td>
		</tr>
		<!-- TODO doc_extra funktionsfähig machen -->
		{% for de in doc_extra %}    
		<tr>
		  <td><b>{{ de.bib_field }}</b></td>
		  <td>{{ de.content }}</td>
		</tr>
		<tr>
		  <td><b>ID in der Bibliothek:</b></td>
		  <td>{{ documents.bib_no }}</td>
		</tr>
		<tr>
		  <td><b>Inventarnummer:</b></td>
		  <td>{{ documents.inv_no }}</td>
		</tr>
		<tr>
		  <td><b>ISBN:</b></td>
		  <td>
			{% if documents.isbn %}
			{{ documents.isbn }}
			{% else %}
			-
			{% endif %}
		  </td>
		</tr>
		<td><b>Preis:</b></td>
		  <td>
			{% if documents.price and documents.currency %}
			{{ documents.price }}{{ documents.currency }}
			{% else %}
			-
			{% endif %}
		  </td>
		<tr>
		  <td><b>BibTeX-ID:</b></td>
		  <td>{{ documents.bibtex_id }}</td>
		</tr>
		<tr>
		  <td><b>LibraryOfCongressN:</b></td>
		  <td>
			{% if documents.lib_of_con_nr %}
			{{ documents.lib_of_con_nr }}
			{% else %}
			-
			{% endif %}
		  </td>
		</tr>
		{% endfor %}
	  </table>
	  
	</td>
	<td>
	  <!-- TODO evtl Schriftfarben ändern -->
	  {% if documents.status == 0 %}
	  <form action="" method="post">
		<input type="submit" name="lend" value="Ausleihen" /> 
	  </form><br />
	  {% else %}
	  {% if documents.status == 1 %}    
	  {% if lending %}
	  {% if lending.non_user_lend %}
	  Das Dokument ist von {{ lending.non_user_lend.first_name }} {{ lending.non_user_lend.last_name }} ausgeliehen. <br />
	  Als Bürge fungiert {{ lending.user_lend.first_name }} {{ lending.user_lend.last_name }}. <br />
	  {% else %}
	  Das Dokument ist von {{ lending.user_lend.first_name }} {{ lending.user_lend.last_name }} ausgeliehen. <br />
	  {% endif %}
	  <!-- TODO Button leben einhauchen -->
	  <input type="button" name="assign" value="&Uuml;bertragen" /> <br />
	  {% if lending.user_lend.username == user.username %}
	  <form action="" method="post">
	    <input type="submit" name="restitution" value="R&uuml;ckgabe" /> <br />
	  </form><br />
	  <form action="" method="post">
		<input type="submit" name="lost" value="Verloren melden" /> <br />
	  </form><br />
	  {% endif %}
	  {% endif %}
	  {% else %}
	  {% if documents.status == 2 %}
	  Das gewünschte Dokument ist derzeit erst bestellt und steht noch nicht zur Ausleihe bereit. <br />
	  {% else %}
	  {% if documents.status == 3 %}
	  Das gewünschte Dokument wurde vor kurzem vermisst gemeldet. <br />
	  <!-- TODO Mail an den Bibliothekar wenn gefunden -->
	  <form action="" method="post">
		<input type="submit" name="found" value="Gefunden melden" /> <br />
	  </form><br />
	  {% else %}
	  Dieses Dokument gilt als verloren. <br />
	  {% endif %}  
	  {% endif %}
	  {% endif %}
	  {% endif %}
	</td>
  </tr>
</table>

<input type="button" name="bibtex" value="BibTeX" onclick="spoiler(this,'spoiler','BibTeX','BibTeX verbergen')"> <br />
<div id="spoiler" name="spoiler" style="display: none;"><textarea cols="63"
	rows="15" readonly="true">{{ bi }}</textarea></div>
	
	
    <h3>History dieses Dokuments</h3>
   
     
    
    
    <table> 
    {% for i in 0123456789|make_list %}
    <tr>
    <td>{{ for s in document.doc_status.all }}
        {{ s.date }}</td>
    <td>{{ s.status }}</td>
    <td>{{ s.recent_user }}
        {% endfor %}</td>
    </tr>
    {% endfor %}
    </table>
    
    
{% endblock %}
